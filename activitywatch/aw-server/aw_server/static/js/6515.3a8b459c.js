(self["webpackChunkaw_webui"]=self["webpackChunkaw_webui"]||[]).push([[6515,9280],{99280:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>p});let n={};const s={name:"fa-icon",props:{name:{type:String,validator(t){return!t||t in n||(console.warn(`Invalid prop: prop "name" is referring to an unregistered icon "${t}".\nPlease make sure you have imported this icon before using it.`),!1)}},title:String,scale:[Number,String],spin:Boolean,inverse:Boolean,pulse:Boolean,flip:{validator(t){return"horizontal"===t||"vertical"===t}},label:String,tabindex:[Number,String]},data(){return{id:l(),x:!1,y:!1,childrenWidth:0,childrenHeight:0,outerScale:1}},computed:{normalizedScale(){let t=this.scale;return t="undefined"===typeof t?1:Number(t),isNaN(t)||t<=0?(console.warn('Invalid prop: prop "scale" should be a number over 0.',this),this.outerScale):t*this.outerScale},klass(){return{"fa-icon":!0,"fa-spin":this.spin,"fa-flip-horizontal":"horizontal"===this.flip,"fa-flip-vertical":"vertical"===this.flip,"fa-inverse":this.inverse,"fa-pulse":this.pulse,[this.$options.name]:!0}},icon(){return this.name?n[this.name]:null},box(){return this.icon?`0 0 ${this.icon.width} ${this.icon.height}`:`0 0 ${this.width} ${this.height}`},ratio(){if(!this.icon)return 1;let{width:t,height:e}=this.icon;return Math.max(t,e)/16},width(){return this.childrenWidth||this.icon&&this.icon.width/this.ratio*this.normalizedScale||0},height(){return this.childrenHeight||this.icon&&this.icon.height/this.ratio*this.normalizedScale||0},style(){return 1!==this.normalizedScale&&{fontSize:this.normalizedScale+"em"}},raw(){if(!this.icon||!this.icon.raw)return null;let t=this.icon.raw,e={};return t=t.replace(/\s(?:xml:)?id=(["']?)([^"')\s]+)\1/g,((t,r,n)=>{let s=l();return e[n]=s,` id="${s}"`})),t=t.replace(/#(?:([^'")\s]+)|xpointer\(id\((['"]?)([^')]+)\2\)\))/g,((t,r,n,s)=>{let a=r||s;return a&&e[a]?`#${e[a]}`:t})),t},focusable(){let{tabindex:t}=this;if(null==t)return"false";let e="string"===typeof t?parseInt(t,10):t;return e>=0?null:"false"}},mounted(){this.updateStack()},updated(){this.updateStack()},methods:{updateStack(){if(!this.name&&null!==this.name&&0===this.$children.length)return void console.warn('Invalid prop: prop "name" is required.');if(this.icon)return;let t=0,e=0;this.$children.forEach((r=>{r.outerScale=this.normalizedScale,t=Math.max(t,r.width),e=Math.max(e,r.height)})),this.childrenWidth=t,this.childrenHeight=e,this.$children.forEach((r=>{r.x=(t-r.width)/2,r.y=(e-r.height)/2}))}},render(t){if(null===this.name)return t();let e={class:this.klass,style:this.style,attrs:{role:this.$attrs.role||(this.label||this.title?"img":null),"aria-label":this.label||null,"aria-hidden":String(!(this.label||this.title)),tabindex:this.tabindex,x:this.x,y:this.y,width:this.width,height:this.height,viewBox:this.box,focusable:this.focusable}},r=`vat-${this.id}`;if(this.title&&(e.attrs["aria-labelledby"]=r),this.raw){let t=this.raw;this.title&&(t=`<title id="${r}">${c(this.title)}</title>${t}`),e.domProps={innerHTML:t}}let n=this.title?[t("title",{attrs:{id:r}},this.title)]:[];return t("svg",e,this.raw?null:n.concat(this.$slots.default||[...this.icon.paths.map(((e,r)=>t("path",{attrs:e,key:`path-${r}`}))),...this.icon.polygons.map(((e,r)=>t("polygon",{attrs:e,key:`polygon-${r}`})))]))},register(t){for(let e in t){let r=t[e],{paths:s=[],d:i,polygons:l=[],points:o}=r;i&&s.push({d:i}),o&&l.push({points:o}),n[e]=a({},r,{paths:s,polygons:l})}},icons:n};function a(t,...e){return e.forEach((e=>{for(let r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})),t}let i=870711;function l(){return`va-${(i++).toString(16)}`}const o={"<":"&lt;",">":"&gt;",'"':"&quot;","&":"&amp;"};function c(t){return t.replace(/[<>"&]/g,(t=>o[t]||t))}const u=s;var h,d,f=r(1001),g=(0,f.Z)(u,h,d,!1,null,null,null);const p=g.exports},6515:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>$});r(68309),r(69600);var n=function(){var t=this,e=t._self._c;return e("div",[e("h3",[t._v("Alerts")]),e("b-alert",{staticStyle:{},attrs:{show:""}},[t._v("This feature is still in early development.")]),t.error?e("b-alert",{attrs:{show:"",variant:"danger"}},[t._v(t._s(t.error))]):t._e(),t._l(t.alerts,(function(r){return e("b-card",{key:r.name},[e("b-button",{staticClass:"float-right",attrs:{size:"sm",variant:"outline-danger"},on:{click:function(e){return t.deleteAlert(r.name)}}},[e("icon",{attrs:{name:"trash"}})],1),e("div",[t._v("Goal name: "+t._s(r.name))]),e("div",[t._v("Category: "+t._s(r.category.join(" > ")))]),e("div",[t._v("Current: "+t._s(t._f("friendlyduration")(t.alertTime(r.category)))+" / "+t._s(r.goal)+" minutes"),t.alertTime(r.category)>=r.goal?e("span",[e("icon",{staticStyle:{color:"#0C0"},attrs:{name:"check"}})],1):e("span",[e("icon",{attrs:{name:"times",color:"#555"}})],1)])],1)})),e("b-input-group",{staticClass:"mt-3"},[e("b-btn",{attrs:{variant:"success"},on:{click:t.check}},[t._v("Check")]),e("b-input-group-append",[e("b-form-checkbox",{staticClass:"my-2 ml-3",attrs:{switch:""},on:{change:t.toggleAutoRefresh},model:{value:t.autorefresh,callback:function(e){t.autorefresh=e},expression:"autorefresh"}},[t._v("Toggle autorefresh every 10s")])],1)],1),t.last_updated?e("small",[t._v("Last updated: "+t._s(t.last_updated))]):t._e(),e("hr"),e("div",[e("h4",[t._v("New alert")]),e("b-form-group",{attrs:{label:"Name","label-cols-md":"2"}},[e("b-input",{model:{value:t.editing_alert.name,callback:function(e){t.$set(t.editing_alert,"name",e)},expression:"editing_alert.name"}})],1),e("b-form-group",{attrs:{label:"Category","label-cols-md":"2"}},[e("b-select",{model:{value:t.editing_alert.category,callback:function(e){t.$set(t.editing_alert,"category",e)},expression:"editing_alert.category"}},t._l(t.categories,(function(r){return e("option",{domProps:{value:r.value}},[t._v(t._s(r.text))])})),0)],1),e("b-form-group",{attrs:{label:"Goal","label-cols-md":"2"}},[e("b-input-group",{attrs:{append:"minutes"}},[e("b-input",{attrs:{type:"number"},model:{value:t.editing_alert.goal,callback:function(e){t.$set(t.editing_alert,"goal",e)},expression:"editing_alert.goal"}})],1)],1),e("div",[e("b-btn",{attrs:{variant:"success"},on:{click:t.addAlert}},[e("icon",{attrs:{name:"plus"}}),t._v("Add alert")],1)],1)],1)],2)},s=[],a=r(73326),i=r(14475),l=r(84542),o=r(65370),c=r(73303),u=r.n(c),h=r(7739),d=r.n(h),f=r(35161),g=r.n(f),p=(r(69720),r(23157),r(92222),r(57327),r(41539),r(32564),r(21249),r(74916),r(23123),r(73210),r(38559),r(83710),r(30381)),v=r.n(p),m=r(79866),_=(r(46125),r(99280));_["default"].register({check:{width:512,height:512,paths:[{d:"M173.9 439.4l-166.4-166.4c-10-10-10-26.2 0-36.2l36.2-36.2c10-10 26.2-10 36.2 0l112.1 112.1 240.1-240.1c10-10 26.2-10 36.2 0l36.2 36.2c10 10 10 26.2 0 36.2l-294.4 294.4c-10 10-26.2 10-36.2 0z"}]}});r(14169),r(96886);var b=r(68184),y=r(2313);const w={name:"Alerts",data:function(){return{bucketsStore:(0,b.U)(),categoryStore:(0,y.v)(),alerts:[{name:"Work",category:["Work"],goal:100},{name:"Media",category:["Media"],goal:10}],editing_alert:{},alert_times:{},error:"",hostnames:[],hostname:"",last_updated:null,autorefresh:!1,running_interval:null,show_options:!1,use_regex:!0,filter_afk:!0}},computed:{categories:function(){return this.categoryStore.category_select(!0)},alertTime:function(){var t=this;return function(e){var r=0;return g()(Object.entries(t.alert_times),(function(t){var n=(0,o.Z)(t,2),s=n[0],a=n[1];s.startsWith(e.join(","))&&(r+=a)})),r}}},mounted:function(){var t=(0,l.Z)((0,i.Z)().mark((function t(){return(0,i.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.bucketsStore.ensureLoaded();case 2:return t.next=4,this.categoryStore.load();case 4:this.hostnames=this.bucketsStore.hosts,this.hostname=this.hostnames[0];case 6:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),methods:{addAlert:function(){this.alerts=this.alerts.concat((0,a.Z)({},this.editing_alert))},deleteAlert:function(t){this.alerts=this.alerts.filter((function(e){return e.name!==t}))},toggleAutoRefresh:function(){!this.autorefresh||this.running_interval?(console.log("Stopping autorefresh"),clearInterval(this.running_interval),this.autorefresh=!1,this.running_interval=null):(console.log("Starting autorefresh"),this.autorefresh=!0,this.running_interval=setInterval(this.check,1e4))},check:function(){var t=(0,l.Z)((0,i.Z)().mark((function t(){var e,r,n,s,a,l,c,h;return(0,i.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=(0,m.l8)({bid_window:"aw-watcher-window_"+this.hostname,bid_afk:"aw-watcher-afk_"+this.hostname,filter_afk:this.filter_afk,classes:(0,y.v)().classes_for_query,filter_classes:null}),e+="; RETURN = events;",r=e.split(";").map((function(t){return t.trim()+";"})),n=v()().subtract(1,"days").startOf("day"),s=v()(n).add(1,"days"),a=[n.format()+"/"+s.format()],t.prev=6,this.status="searching",t.next=10,this.$aw.query(a,r);case 10:l=t.sent,this.events=l[0],this.error="",t.next=20;break;case 15:return t.prev=15,t.t0=t["catch"](6),console.error(t.t0),this.error=t.t0.response.data.message,t.abrupt("return");case 20:return t.prev=20,this.status=null,t.finish(20);case 23:c=d()(this.events,(function(t){return t.data.$category})),h=Object.fromEntries(g()(Object.entries(c),(function(t){var e=(0,o.Z)(t,2),r=e[0],n=e[1];return[r.split(","),u()(n,"duration")]}))),this.alert_times=h,this.last_updated=new Date;case 27:case"end":return t.stop()}}),t,this,[[6,15,20,23]])})));function e(){return t.apply(this,arguments)}return e}()}},x=w;var k=r(1001),S=(0,k.Z)(x,n,s,!1,null,"faae96d0",null);const $=S.exports},96874:t=>{function e(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}t.exports=e},5976:(t,e,r)=>{var n=r(6557),s=r(45357),a=r(30061);function i(t,e){return a(s(t,e,n),t+"")}t.exports=i},56560:(t,e,r)=>{var n=r(75703),s=r(38777),a=r(6557),i=s?function(t,e){return s(t,"toString",{configurable:!0,enumerable:!1,value:n(e),writable:!0})}:a;t.exports=i},67762:t=>{function e(t,e){var r,n=-1,s=t.length;while(++n<s){var a=e(t[n]);void 0!==a&&(r=void 0===r?a:r+a)}return r}t.exports=e},16612:(t,e,r)=>{var n=r(77813),s=r(98612),a=r(65776),i=r(13218);function l(t,e,r){if(!i(r))return!1;var l=typeof e;return!!("number"==l?s(r)&&a(e,r.length):"string"==l&&e in r)&&n(r[e],t)}t.exports=l},45357:(t,e,r)=>{var n=r(96874),s=Math.max;function a(t,e,r){return e=s(void 0===e?t.length-1:e,0),function(){var a=arguments,i=-1,l=s(a.length-e,0),o=Array(l);while(++i<l)o[i]=a[e+i];i=-1;var c=Array(e+1);while(++i<e)c[i]=a[i];return c[e]=r(o),n(t,this,c)}}t.exports=a},30061:(t,e,r)=>{var n=r(56560),s=r(21275),a=s(n);t.exports=a},21275:t=>{var e=800,r=16,n=Date.now;function s(t){var s=0,a=0;return function(){var i=n(),l=r-(i-a);if(a=i,l>0){if(++s>=e)return arguments[0]}else s=0;return t.apply(void 0,arguments)}}t.exports=s},75703:t=>{function e(t){return function(){return t}}t.exports=e},85564:(t,e,r)=>{var n=r(21078);function s(t){var e=null==t?0:t.length;return e?n(t,1):[]}t.exports=s},6162:(t,e,r)=>{var n=r(56029),s=r(53325),a=r(6557);function i(t){return t&&t.length?n(t,a,s):void 0}t.exports=i},89734:(t,e,r)=>{var n=r(21078),s=r(82689),a=r(5976),i=r(16612),l=a((function(t,e){if(null==t)return[];var r=e.length;return r>1&&i(t,e[0],e[1])?e=[]:r>2&&i(e[0],e[1],e[2])&&(e=[e[0]]),s(t,n(e,1),[])}));t.exports=l},73303:(t,e,r)=>{var n=r(67206),s=r(67762);function a(t,e){return t&&t.length?s(t,n(e,2)):0}t.exports=a},45578:(t,e,r)=>{var n=r(67206),s=r(45652);function a(t,e){return t&&t.length?s(t,n(e,2)):[]}t.exports=a},2313:(t,e,r)=>{"use strict";r.d(e,{v:()=>y});var n=r(35161),s=r.n(n),a=r(6162),i=r.n(a),l=r(18446),o=r.n(l),c=r(85564),u=r.n(c),h=r(45578),d=r.n(h),f=r(89734),g=r.n(f),p=r(50361),v=r.n(p),m=(r(21249),r(57327),r(41539),r(68309),r(47042),r(69600),r(69826),r(2707),r(92222),r(21692)),_=r(55208),b=r(33205),y=(0,b.Q_)("categories",{state:function(){return{classes:[],classes_unsaved_changes:!1}},getters:{classes_clean:function(){return this.classes.map(m.cleanCategory)},classes_hierarchy:function(){var t=(0,m.build_category_hierarchy)(v()(this.classes));return g()(t,[function(t){return t.id||0}])},classes_for_query:function(){return this.classes.filter((function(t){return null!==t.rule.type})).map((function(t){return[t.name,t.rule]}))},all_categories:function(){return d()(u()(this.classes.map((function(t){for(var e=[],r=1;r<=t.name.length;r++)e.push(t.name.slice(0,r));return e}))),(function(t){return t.join(">>>>")}))},allCategoriesSelect:function(){var t=this.all_categories,e=t.map((function(t){return{text:t.join(" > "),value:t,id:t.id}}));return g()(e,"text")},get_category:function(){var t=this;return function(e){("string"===typeof e||e instanceof String)&&console.error("Passed category was string, expected array. Lookup will fail.");var r=t.classes.find((function(t){return o()(t.name,e)}));return r?(0,m.annotate)(v()(r)):(o()(e,["Uncategorized"])||console.error("Couldn't find category: ",e),{name:["Uncategorized"],rule:{type:"none"}})}},get_category_by_id:function(){var t=this;return function(e){return(0,m.annotate)(v()(t.classes.find((function(t){return t.id==e}))))}},get_category_color:function(){var t=this;return function(e){return(0,_.EB)(t.get_category(e),t.classes)}},category_select:function(){var t=this;return function(e){var r=t.all_categories;return r=r.map((function(t){return{text:t.join(" > "),value:t}})).sort((function(t,e){return t.text>e.text})),e&&(r=[{text:"All",value:null},{text:"Uncategorized",value:["Uncategorized"]}].concat(r)),r}}},actions:{load:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;null===t&&(t=(0,m.loadClasses)()),t=(0,m.createMissingParents)(t);var e=0;this.classes=t.map((function(t){return Object.assign(t,{id:e++})})),this.classes_unsaved_changes=!1},save:function(){var t=(0,m.saveClasses)(this.classes);return this.classes_unsaved_changes=!1,t},import:function(t){var e=0;this.classes=t.map((function(t){return Object.assign(t,{id:e++})})),this.classes_unsaved_changes=!0},updateClass:function(t){console.log("Updating class:",t);var e=this.classes.find((function(e){return e.id===t.id})),r=e.name,n=e.name.length;void 0===t.id||null===t.id?(t.id=i()(s()(this.classes,"id"))+1,this.classes.push(t)):Object.assign(e,t),s()(this.classes,(function(e){o()(r,e.name.slice(0,n))&&(e.name=t.name.concat(e.name.slice(n)),console.log("Renamed child:",e.name))})),this.classes_unsaved_changes=!0},addClass:function(t){t.id=i()(s()(this.classes,"id"))+1,this.classes.push(t),this.classes_unsaved_changes=!0},removeClass:function(t){this.classes=this.classes.filter((function(e){return e.id!==t})),this.classes_unsaved_changes=!0},appendClassRule:function(t,e){var r=this.classes.find((function(e){return e.id===t}));"none"===r.rule.type||null===r.rule.type?(r.rule.type="regex",r.rule.regex=e):"regex"===r.rule.type&&(r.rule.regex+="|"+e),this.classes_unsaved_changes=!0},restoreDefaultClasses:function(){var t=0;this.classes=(0,m.createMissingParents)(m.defaultCategories).map((function(e){return Object.assign(e,{id:t++})})),this.classes_unsaved_changes=!0},clearAll:function(){this.classes=[],this.classes_unsaved_changes=!0}}})},46125:(t,e,r)=>{"use strict";var n=r(99280);n["default"].register({plus:{width:448,height:512,paths:[{d:"M416 208c17.7 0 32 14.3 32 32v32c0 17.7-14.3 32-32 32h-144v144c0 17.7-14.3 32-32 32h-32c-17.7 0-32-14.3-32-32v-144h-144c-17.7 0-32-14.3-32-32v-32c0-17.7 14.3-32 32-32h144v-144c0-17.7 14.3-32 32-32h32c17.7 0 32 14.3 32 32v144h144z"}]}})},14169:(t,e,r)=>{"use strict";var n=r(99280);n["default"].register({times:{width:352,height:512,paths:[{d:"M242.7 256l100.1 100.1c12.3 12.3 12.3 32.2 0 44.5l-22.2 22.2c-12.3 12.3-32.2 12.3-44.5 0l-100.1-100.1-100.1 100.1c-12.3 12.3-32.2 12.3-44.5 0l-22.2-22.2c-12.3-12.3-12.3-32.2 0-44.5l100.1-100.1-100.1-100.1c-12.3-12.3-12.3-32.2 0-44.5l22.2-22.2c12.3-12.3 32.2-12.3 44.5 0l100.1 100.1 100.1-100.1c12.3-12.3 32.2-12.3 44.5 0l22.2 22.2c12.3 12.3 12.3 32.2 0 44.5z"}]}})},96886:(t,e,r)=>{"use strict";var n=r(99280);n["default"].register({trash:{width:448,height:512,paths:[{d:"M432 32c8.8 0 16 7.2 16 16v32c0 8.8-7.2 16-16 16h-416c-8.8 0-16-7.2-16-16v-32c0-8.8 7.2-16 16-16h120l9.4-18.7c3.6-7.3 13.1-13.3 21.3-13.3h0.1 114.3 0c8.2 0 17.8 6 21.5 13.3l9.4 18.7h120zM53.2 467l-21.2-339h384l-21.2 339c-1.6 24.8-23 45-47.9 45h-245.8c-24.9 0-46.3-20.2-47.9-45z"}]}})}}]);
//# sourceMappingURL=6515.3a8b459c.js.map